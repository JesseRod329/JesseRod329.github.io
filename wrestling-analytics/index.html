<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wrestling Analytics Dashboard - 594 Wrestlers</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter', system-ui, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            color: #333;
        }
        .container { max-width: 1600px; margin: 0 auto; padding: 20px; }
        .dashboard-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            text-align: center;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }
        .dashboard-header h1 {
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        .hero-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        .metric-card {
            background: rgba(30, 60, 114, 0.1);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border: 1px solid rgba(30, 60, 114, 0.2);
        }
        .metric-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1e3c72;
            display: block;
        }
        .metric-label {
            color: #666;
            font-size: 0.9rem;
            margin-top: 5px;
        }
        .dashboard-grid {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }
        .filters-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 15px;
            padding: 25px;
            height: fit-content;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .visualizations {
            display: grid;
            gap: 25px;
        }
        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .tabs {
            display: flex;
            margin-bottom: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 5px;
        }
        .tab {
            flex: 1;
            padding: 12px 20px;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            color: #666;
        }
        .tab.active {
            background: white;
            color: #1e3c72;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .chart-canvas {
            width: 100%;
            height: 400px;
        }
        .loading {
            text-align: center;
            padding: 60px;
            font-size: 1.2rem;
            color: #666;
        }
        .spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #1e3c72;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        @media (max-width: 1024px) {
            .dashboard-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="dashboard-header">
            <h1>üèÜ Wrestling Analytics Dashboard</h1>
            <p>Professional wrestling data visualization and analytics platform</p>
            
            <div class="hero-metrics">
                <div class="metric-card">
                    <span class="metric-number" id="total-matches">0</span>
                    <div class="metric-label">Total Matches</div>
                </div>
                <div class="metric-card">
                    <span class="metric-number" id="total-wrestlers">594</span>
                    <div class="metric-label">Wrestlers</div>
                </div>
                <div class="metric-card">
                    <span class="metric-number" id="total-promotions">0</span>
                    <div class="metric-label">Promotions</div>
                </div>
                <div class="metric-card">
                    <span class="metric-number" id="avg-matches">0</span>
                    <div class="metric-label">Avg Matches/Wrestler</div>
                </div>
            </div>
        </div>

        <div class="dashboard-grid">
            <div class="filters-panel">
                <h3>üîç Filters & Search</h3>
                <input type="text" id="wrestler-search" placeholder="Search wrestlers..." style="width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #e1e5e9; border-radius: 8px;">
                <select id="promotion-filter" style="width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #e1e5e9; border-radius: 8px;">
                    <option value="">All Promotions</option>
                </select>
            </div>

            <div class="visualizations">
                <div class="chart-container">
                    <div class="tabs">
                        <div class="tab active" data-tab="timeline">üìà Timeline</div>
                        <div class="tab" data-tab="promotions">üè¢ Promotions</div>
                        <div class="tab" data-tab="wrestlers">üë• Wrestlers</div>
                    </div>
                    
                    <div id="timeline-view">
                        <canvas id="timeline-chart" class="chart-canvas"></canvas>
                    </div>

                    <div id="promotions-view" style="display: none;">
                        <canvas id="promotions-chart" class="chart-canvas"></canvas>
                    </div>

                    <div id="wrestlers-view" style="display: none;">
                        <div id="wrestlers-list">
                            <div class="loading">
                                <div class="spinner"></div>
                                <div>Loading wrestler data...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let allMatches = [];
        let allWrestlers = [];
        let charts = {};
        let currentTab = 'timeline';

        const wrestlerFiles = [
            'John_Cena_matches.csv', 'Roman_Reigns_matches.csv', 'Brock_Lesnar_matches.csv',
            'CM_Punk_matches.csv', 'Seth_Rollins_matches.csv', 'AJ_Styles_matches.csv',
            'The_Rock_matches.csv', 'Triple_H_matches.csv', 'Undertaker_matches.csv',
            'Kane_matches.csv'
        ];

        async function parseCSV(filename) {
            try {
                console.log(`Loading ${filename}...`);
                const response = await fetch(`https://raw.githubusercontent.com/JesseRod329/JesseRod329.github.io/main/wresltedash/${filename}`);
                if (!response.ok) throw new Error(`Failed to load ${filename}`);
                
                const text = await response.text();
                const lines = text.split('\\n').filter(line => line.trim());
                const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
                
                const matches = [];
                for (let i = 1; i < lines.length; i++) {
                    const values = lines[i].split(',').map(v => v.trim().replace(/"/g, ''));
                    if (values.length >= headers.length) {
                        const match = {};
                        headers.forEach((header, index) => {
                            match[header] = values[index] || '';
                        });
                        
                        if (match.date) {
                            const dateParts = match.date.split('.');
                            if (dateParts.length === 3) {
                                match.parsedDate = new Date(`${dateParts[2]}-${dateParts[1]}-${dateParts[0]}`);
                                match.year = parseInt(dateParts[2]);
                            }
                        }
                        
                        match.wrestler = filename.replace('_matches.csv', '').replace(/_/g, ' ');
                        match.promotion = extractPromotion(match.event || '');
                        matches.push(match);
                    }
                }
                return matches;
            } catch (error) {
                console.error(`Error loading ${filename}:`, error);
                return [];
            }
        }

        function extractPromotion(event) {
            if (event.toLowerCase().includes('wwe')) return 'WWE';
            if (event.toLowerCase().includes('aew')) return 'AEW';
            if (event.toLowerCase().includes('njpw')) return 'NJPW';
            if (event.toLowerCase().includes('tna') || event.toLowerCase().includes('impact')) return 'TNA';
            return 'Independent';
        }

        async function loadAllData() {
            console.log('Loading wrestler data...');
            allMatches = [];
            allWrestlers = [];
            
            for (const file of wrestlerFiles) {
                const matches = await parseCSV(file);
                if (matches.length > 0) {
                    allMatches.push(...matches);
                    allWrestlers.push({
                        name: file.replace('_matches.csv', '').replace(/_/g, ' '),
                        matches: matches,
                        totalMatches: matches.length
                    });
                }
            }
            
            updateMetrics();
            populateFilters();
            renderCurrentView();
            console.log(`Loaded ${allMatches.length} matches from ${allWrestlers.length} wrestlers`);
        }

        function updateMetrics() {
            const totalMatches = allMatches.length;
            const uniquePromotions = [...new Set(allMatches.map(m => m.promotion))].length;
            const avgMatches = allWrestlers.length > 0 ? Math.round(totalMatches / allWrestlers.length) : 0;
            
            document.getElementById('total-matches').textContent = totalMatches.toLocaleString();
            document.getElementById('total-promotions').textContent = uniquePromotions;
            document.getElementById('avg-matches').textContent = avgMatches;
        }

        function populateFilters() {
            const promotions = [...new Set(allMatches.map(m => m.promotion))].sort();
            const select = document.getElementById('promotion-filter');
            promotions.forEach(promo => {
                if (promo) {
                    const option = document.createElement('option');
                    option.value = promo;
                    option.textContent = promo;
                    select.appendChild(option);
                }
            });
        }

        function renderTimelineChart() {
            const ctx = document.getElementById('timeline-chart').getContext('2d');
            const yearlyData = {};
            allMatches.forEach(match => {
                if (match.year) {
                    yearlyData[match.year] = (yearlyData[match.year] || 0) + 1;
                }
            });
            
            const years = Object.keys(yearlyData).sort();
            const counts = years.map(year => yearlyData[year]);

            if (charts.timeline) charts.timeline.destroy();
            
            charts.timeline = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'Matches per Year',
                        data: counts,
                        borderColor: '#1e3c72',
                        backgroundColor: 'rgba(30, 60, 114, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { beginAtZero: true },
                        x: { title: { display: true, text: 'Year' } }
                    }
                }
            });
        }

        function renderPromotionsChart() {
            const ctx = document.getElementById('promotions-chart').getContext('2d');
            const promotionData = {};
            allMatches.forEach(match => {
                const promo = match.promotion || 'Unknown';
                promotionData[promo] = (promotionData[promo] || 0) + 1;
            });
            
            if (charts.promotions) charts.promotions.destroy();
            
            charts.promotions = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(promotionData),
                    datasets: [{
                        data: Object.values(promotionData),
                        backgroundColor: ['#1e3c72', '#2a5298', '#3d6bb3', '#5084ce', '#639de9']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        function renderWrestlersList() {
            const html = allWrestlers.map(wrestler => `
                <div style="background: white; padding: 15px; margin: 10px 0; border-radius: 10px; cursor: pointer; box-shadow: 0 2px 10px rgba(0,0,0,0.1);" onclick="alert('Selected: ${wrestler.name}')">
                    <div style="font-weight: bold; color: #1e3c72;">${wrestler.name}</div>
                    <div style="color: #666; font-size: 0.9rem;">${wrestler.totalMatches} matches</div>
                </div>
            `).join('');
            
            document.getElementById('wrestlers-list').innerHTML = html;
        }

        function switchTab(tabName) {
            document.querySelectorAll('[id$="-view"]').forEach(view => view.style.display = 'none');
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            
            document.getElementById(`${tabName}-view`).style.display = 'block';
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            
            currentTab = tabName;
            renderCurrentView();
        }

        function renderCurrentView() {
            switch(currentTab) {
                case 'timeline': renderTimelineChart(); break;
                case 'promotions': renderPromotionsChart(); break;
                case 'wrestlers': renderWrestlersList(); break;
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => switchTab(tab.dataset.tab));
            });
            loadAllData();
        });
    </script>
  </body>
</html>
