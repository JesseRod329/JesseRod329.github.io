const canvas = document.getElementById('pixelCanvas'), ctx = canvas.getContext('2d'), colorPicker = document.getElementById('colorPicker'), clearBtn = document.getElementById('clearBtn'), exportBtn = document.getElementById('exportBtn'), framesList = document.getElementById('framesList'), addFrameBtn = document.getElementById('addFrameBtn'), playBtn = document.getElementById('playBtn'); const gridSize = 16; let frames = [], currentFrame = 0, isDrawing = !1, isPlaying = !1; canvas.width = canvas.height = 512; function initFrame() { return Array(gridSize).fill(null).map(() => Array(gridSize).fill('#000')) } frames.push(initFrame()); function drawGrid() { ctx.clearRect(0, 0, canvas.width, canvas.height); const cellSize = canvas.width / gridSize; for (let y = 0; y < gridSize; y++)for (let x = 0; x < gridSize; x++) { ctx.fillStyle = frames[currentFrame][y][x]; ctx.fillRect(x * cellSize, y * cellSize, cellSize, cellSize); ctx.strokeStyle = '#333'; ctx.strokeRect(x * cellSize, y * cellSize, cellSize, cellSize) } } function getGridPos(e) { const rect = canvas.getBoundingClientRect(), cellSize = canvas.width / gridSize, x = Math.floor((e.clientX - rect.left) / (rect.width / gridSize)), y = Math.floor((e.clientY - rect.top) / (rect.height / gridSize)); return { x, y } } canvas.addEventListener('mousedown', e => { isDrawing = !0; const { x, y } = getGridPos(e); frames[currentFrame][y][x] = colorPicker.value; drawGrid() }); canvas.addEventListener('mousemove', e => { if (!isDrawing) return; const { x, y } = getGridPos(e); frames[currentFrame][y][x] = colorPicker.value; drawGrid() }); canvas.addEventListener('mouseup', () => isDrawing = !1); clearBtn.addEventListener('click', () => { frames[currentFrame] = initFrame(); drawGrid() }); addFrameBtn.addEventListener('click', () => { frames.push(initFrame()); currentFrame = frames.length - 1; renderFrames(); drawGrid() }); function renderFrames() { framesList.innerHTML = frames.map((f, i) => `<div class="frame-item ${i === currentFrame ? 'active' : ''}" onclick="selectFrame(${i})">Frame ${i + 1}</div>`).join('') } function selectFrame(i) { currentFrame = i; renderFrames(); drawGrid() } window.selectFrame = selectFrame; playBtn.addEventListener('click', () => { if (isPlaying) { isPlaying = !1; playBtn.textContent = '▶ Play' } else { isPlaying = !0; playBtn.textContent = '⏸ Pause'; playAnimation() } }); function playAnimation() { if (!isPlaying) return; currentFrame = (currentFrame + 1) % frames.length; drawGrid(); renderFrames(); setTimeout(playAnimation, 200) } exportBtn.addEventListener('click', () => { const link = document.createElement('a'); link.download = 'pixel-art.png'; link.href = canvas.toDataURL(); link.click() }); renderFrames(); drawGrid();
