const input = document.getElementById('equationInput'), canvas = document.getElementById('mathCanvas'), ctx = canvas.getContext('2d'); canvas.width = canvas.offsetWidth * 2; canvas.height = 1200; ctx.scale(2, 2); function drawAxes() { const w = canvas.width / 2, h = canvas.height / 2; ctx.strokeStyle = '#333'; ctx.lineWidth = 1; ctx.beginPath(); ctx.moveTo(0, h / 2); ctx.lineTo(w, h / 2); ctx.moveTo(w / 2, 0); ctx.lineTo(w / 2, h); ctx.stroke(); ctx.fillStyle = '#666'; ctx.font = '12px monospace'; for (let i = -10; i <= 10; i++) { if (i === 0) continue; ctx.fillText(i, w / 2 + i * 30 + 5, h / 2 - 5); ctx.fillText(i, w / 2 + 5, h / 2 - i * 30) } } function plotEquation(eq) { ctx.clearRect(0, 0, canvas.width / 2, canvas.height / 2); drawAxes(); const w = canvas.width / 2, h = canvas.height / 2; ctx.strokeStyle = '#6366f1'; ctx.lineWidth = 2; ctx.beginPath(); let firstPoint = !0; for (let px = 0; px < w; px++) { const x = (px - w / 2) / 30; try { const scope = { x, theta: x }; const result = math.evaluate(eq, scope); let y; if (eq.includes('theta')) { const r = result; y = r * Math.sin(x) } else if (eq.includes('=')) { const parts = eq.split('='); y = math.evaluate(parts[1], scope) } else { y = result } const py = h / 2 - y * 30; if (isFinite(py)) { if (firstPoint) { ctx.moveTo(px, py); firstPoint = !1 } else { ctx.lineTo(px, py) } } } catch (e) { } } ctx.stroke() } input.addEventListener('input', () => plotEquation(input.value)); document.querySelectorAll('.preset-btn').forEach(btn => { btn.addEventListener('click', () => { input.value = btn.dataset.eq; plotEquation(input.value) }) }); plotEquation(input.value);
